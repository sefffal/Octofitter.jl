<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Posterior Predictive Checks · Octofitter.jl</title><meta name="title" content="Posterior Predictive Checks · Octofitter.jl"/><meta property="og:title" content="Posterior Predictive Checks · Octofitter.jl"/><meta property="twitter:title" content="Posterior Predictive Checks · Octofitter.jl"/><meta name="description" content="Documentation for Octofitter.jl."/><meta property="og:description" content="Documentation for Octofitter.jl."/><meta property="twitter:description" content="Documentation for Octofitter.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="Octofitter.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Octofitter.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../quick-start/">Quick Start</a></li><li><a class="tocitem" href="../faq/">FAQ</a></li><li><a class="tocitem" href="../migration/">Migration Guide</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Relative Astrometry</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../rel-astrom/">Basic Astrom Fit</a></li><li><a class="tocitem" href="../rel-astrom-obs/">Observable Priors</a></li><li><a class="tocitem" href="../fit-coplanar/">Resonant Co-Planar Model</a></li><li><a class="tocitem" href="../thiele-innes/">Thiele-Innes Parameters</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Radial Velocity</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../rv-1/">Basic RV Fit</a></li><li><a class="tocitem" href="../rv-gp/">Gaussian Process</a></li><li><a class="tocitem" href="../rv-multi-planet/">Multiple Planets</a></li><li><a class="tocitem" href="../fit-rv-rel/">Relative RV Data</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Absolute Astrometry</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../pma/">Proper Motion Anomaly</a></li><li><a class="tocitem" href="../hipparcos/">Hipparcos IAD</a></li><li><a class="tocitem" href="../g23h/">Joint Gaia-Hipparcos (G23H)</a></li><li><a class="tocitem" href="../g23h-example/">G23H Full Example</a></li><li><a class="tocitem" href="../gaia-iad/">Gaia DR4 Epoch Astrometry</a></li><li><a class="tocitem" href="../gaia-dr4-simulation/">Gaia DR4 Simulation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-4" type="checkbox"/><label class="tocitem" for="menuitem-3-4"><span class="docs-label">Images and More</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../images/">Image Data (de-orbiting)</a></li><li><a class="tocitem" href="../extract-phot-astrom/">Extract Astrom. and Photometry</a></li><li><a class="tocitem" href="../mass-photometry/">Connect Mass and Photometry</a></li><li><a class="tocitem" href="../fit-interfere/">Interferometer Data</a></li><li><a class="tocitem" href="../fit-likemap/">Likelihood Map</a></li><li><a class="tocitem" href="../fit-grav-wide/">GRAVITY Wide Data</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-5" type="checkbox"/><label class="tocitem" for="menuitem-3-5"><span class="docs-label">Joint Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../astrom-pma-rv/">Astrometry, PMA, and RV</a></li><li><a class="tocitem" href="../fit-rv-astrom/">RV and Relative Astrometry</a></li><li><a class="tocitem" href="../rv/">RV and Proper Motion Anomaly</a></li><li><a class="tocitem" href="../limits/">Calculate Detection Limits</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-6" type="checkbox" checked/><label class="tocitem" for="menuitem-3-6"><span class="docs-label">Bayesian Workflows</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../eccentric-or-circular/">Circular or Eccentric? Model Comparison</a></li><li><a class="tocitem" href="../data-simulation/">Generating and Fitting Simulated Data</a></li><li><a class="tocitem" href="../prior-pred/">Prior Predictive Checks</a></li><li class="is-active"><a class="tocitem" href>Posterior Predictive Checks</a></li><li><a class="tocitem" href="../cross-validation/">Cross Validation</a></li><li><a class="tocitem" href="../sbc/">Simulation Based Calibration</a></li></ul></li></ul></li><li><span class="tocitem">Documentation</span><ul><li><a class="tocitem" href="../python/">Using Python</a></li><li><a class="tocitem" href="../chains/">Chains</a></li><li><a class="tocitem" href="../octoplot/">Orbit plots with <code>octoplot</code></a></li><li><a class="tocitem" href="../rvpostplot/">RV plots with <code>rvpostplot</code></a></li><li><a class="tocitem" href="../loading-saving/">Loading and Saving Data</a></li><li><a class="tocitem" href="../samplers/">Sampler</a></li><li><a class="tocitem" href="../parallel-sampling/">Distributed Sampling</a></li><li><a class="tocitem" href="../priors/">Priors</a></li><li><a class="tocitem" href="../derived/">Derived Variables</a></li><li><a class="tocitem" href="../custom-likelihood/">Custom Likelihoods</a></li><li><a class="tocitem" href="../kepler/">Kepler Solver</a></li><li><a class="tocitem" href="../compat-orbitize/">Orbitize! Compatibility</a></li><li><a class="tocitem" href="../api/">Full API Documentation</a></li></ul></li><li><span class="tocitem">Developer Documentation</span><ul><li><a class="tocitem" href="../dev/architecture/">Architecture Overview</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li><a class="is-disabled">Bayesian Workflows</a></li><li class="is-active"><a href>Posterior Predictive Checks</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Posterior Predictive Checks</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/sefffal/Octofitter.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/sefffal/Octofitter.jl/blob/main/docs/src/post-pred.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Posterior-Predictive-Checks"><a class="docs-heading-anchor" href="#Posterior-Predictive-Checks">Posterior Predictive Checks</a><a id="Posterior-Predictive-Checks-1"></a><a class="docs-heading-anchor-permalink" href="#Posterior-Predictive-Checks" title="Permalink"></a></h1><p>A posterior predictive check compares our true data with simulated data drawn from the posterior. This allows us to evaluate if the model is able to reproduce our observations appropriately. Samples drawn from the posterior predictive distribution should match the locations of the original data.</p><p>To demonstrate, we will fit a model to relative astrometry data:</p><pre><code class="language-julia hljs">using Octofitter
using Distributions

astrom_dat = Table(
    epoch= [50000,50120,50240,50360,50480,50600,50720,50840,],
    ra = [-505.764,-502.57,-498.209,-492.678,-485.977,-478.11,-469.08,-458.896,],
    dec = [-66.9298,-37.4722,-7.92755,21.6356, 51.1472, 80.5359, 109.729, 138.651,],
    σ_ra = fill(10.0, 8),
    σ_dec = fill(10.0, 8),
    cor = fill(0.0, 8)
)
astrom_obs = PlanetRelAstromObs(astrom_dat, name=&quot;simulated astrom&quot;)

planet_b = Planet(
    name=&quot;b&quot;,
    basis=Visual{KepOrbit},
    observations=[astrom_obs],
    variables=@variables begin
        a ~ truncated(Normal(10, 4), lower=0.1, upper=100)
        e ~ Uniform(0.0, 0.5)
        i ~ Sine()
        ω ~ UniformCircular()
        Ω ~ UniformCircular()
        θ ~ UniformCircular()
        tp = θ_at_epoch_to_tperi(θ,50420; system.M, a, e, i, ω, Ω)  # reference epoch for θ. Choose an MJD date near your data.
    end
)

sys = System(
    name=&quot;Tutoria&quot;,
    companions=[planet_b],
    observations=[],
    variables=@variables begin
        M ~ truncated(Normal(1.2, 0.1), lower=0.1)
        plx ~ truncated(Normal(50.0, 0.02), lower=0.1)
    end
)

model = Octofitter.LogDensityModel(sys)

using Random
Random.seed!(0)
chain = octofit(model)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Chains MCMC chain (1000×28×1 Array{Float64, 3}):

Iterations        = 1:1:1000
Number of chains  = 1
Samples per chain = 1000
Wall duration     = 3.37 seconds
Compute duration  = 3.37 seconds
parameters        = M, plx, b_a, b_e, b_i, b_ωx, b_ωy, b_Ωx, b_Ωy, b_θx, b_θy, b_ω, b_Ω, b_θ, b_tp
internals         = n_steps, is_accept, acceptance_rate, hamiltonian_energy, hamiltonian_energy_error, max_hamiltonian_energy_error, tree_depth, numerical_error, step_size, nom_step_size, is_adapt, loglike, logpost, tree_depth, numerical_error

Summary Statistics
 <span class="sgr1"> parameters         mean         std       mcse    ess_bulk   ess_tail      r ⋯
 <span class="sgr90">     Symbol      Float64     Float64    Float64     Float64    Float64   Floa ⋯

           M       1.1873      0.0883     0.0033    718.5044   722.0107    0.9 ⋯
         plx      49.9999      0.0201     0.0006   1045.9552   476.3477    0.9 ⋯
         b_a      11.7600      2.1190     0.1310    253.3586   322.4434    1.0 ⋯
         b_e       0.1477      0.1052     0.0067    254.5021   555.2656    1.0 ⋯
         b_i       0.6460      0.1470     0.0094    274.5324   223.3653    1.0 ⋯
        b_ωx       0.0256      0.7466     0.0550    208.7238   554.0880    0.9 ⋯
        b_ωy       0.0334      0.6737     0.0578    148.5245   640.6825    1.0 ⋯
        b_Ωx       0.0917      0.7542     0.1048     68.7277   424.5998    1.0 ⋯
        b_Ωy       0.0879      0.6620     0.0800     82.5368   412.8118    1.0 ⋯
        b_θx       0.0750      0.0102     0.0003    893.4947   675.8711    0.9 ⋯
        b_θy      -1.0022      0.0954     0.0037    664.6501   722.0107    0.9 ⋯
         b_ω      -0.1160      1.8140     0.1397    230.1912   522.4317    1.0 ⋯
         b_Ω      -0.3547      1.7099     0.1997    109.7777   313.3970    1.0 ⋯
         b_θ      -1.4961      0.0077     0.0002   1022.3334   741.3550    0.9 ⋯
        b_tp   43428.6886   4758.3669   277.3695    298.1882   344.6987    1.0 ⋯
</span><span class="sgr36">                                                               2 columns omitted

Quantiles
  parameters         2.5%        25.0%        50.0%        75.0%        97.5%
 </span><span class="sgr90">     Symbol      Float64      Float64      Float64      Float64      Float64

           M       1.0151       1.1296       1.1885       1.2497       1.3523
         plx      49.9609      49.9865      49.9997      50.0133      50.0418
         b_a       8.4653      10.1590      11.4897      13.0444      16.5646
         b_e       0.0067       0.0607       0.1295       0.2180       0.3874
         b_i       0.3039       0.5605       0.6631       0.7544       0.8845
        b_ωx      -1.0707      -0.7556       0.1146       0.7774       1.0744
        b_ωy      -1.0509      -0.5724       0.0225       0.6778       1.0569
        b_Ωx      -1.0789      -0.7088       0.2300       0.8220       1.0921
        b_Ωy      -1.0152      -0.4970       0.2034       0.6637       1.0521
        b_θx       0.0559       0.0682       0.0743       0.0818       0.0960
        b_θy      -1.1992      -1.0623      -0.9996      -0.9357      -0.8231
         b_ω      -3.0305      -1.8010       0.0651       1.2052       2.9832
         b_Ω      -2.9941      -2.1182       0.2637       0.8884       2.8076
         b_θ      -1.5107      -1.5014      -1.4962      -1.4908      -1.4811
        b_tp   32621.6606   40864.2312   44433.0924   46896.8460   50032.3173
</span></span></code></pre><p>We now have our posterior as approximated by the MCMC chain. Convert these posterior samples into orbit objects:</p><pre><code class="language-julia hljs"># Instead of creating orbit objects for all rows in the chain, just pick
# every twentieth row.
ii = 1:20:1000
orbits = Octofitter.construct_elements(model, chain, :b, ii)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">50-element Vector{Visual{KepOrbit{Float64}, Float64}}:
 Visual{KepOrbit{Float64}, Float64}(KepOrbit(10.4, 0.0605, 0.592, 2.36, 1.21, 48400.0, 1.26), 50.00054097470339, 4.125251491807883e6)
 Visual{KepOrbit{Float64}, Float64}(KepOrbit(9.1, 0.177, 0.398, 1.07, 0.285, 45000.0, 1.11), 50.0255597050733, 4.1231883753652074e6)
 Visual{KepOrbit{Float64}, Float64}(KepOrbit(10.1, 0.0895, 0.484, -2.69, 3.82, 43600.0, 1.07), 50.00966538480354, 4.1244988275761213e6)
 Visual{KepOrbit{Float64}, Float64}(KepOrbit(16.3, 0.0826, 0.857, 1.21, 3.36, 49700.0, 1.24), 49.9883604255012, 4.126256682383043e6)
 Visual{KepOrbit{Float64}, Float64}(KepOrbit(11.9, 0.00997, 0.655, 0.679, 0.483, 42400.0, 1.22), 49.96955409492288, 4.127809622941057e6)
 Visual{KepOrbit{Float64}, Float64}(KepOrbit(9.85, 0.0302, 0.615, 0.665, 1.28, 45700.0, 1.2), 49.9809509997178, 4.1268683792803576e6)
 Visual{KepOrbit{Float64}, Float64}(KepOrbit(14.9, 0.385, 0.602, 0.0599, 6.02, 33200.0, 1.19), 49.99977267759148, 4.125314880472218e6)
 Visual{KepOrbit{Float64}, Float64}(KepOrbit(12.8, 0.0417, 0.765, 1.09, 0.327, 42000.0, 1.21), 50.01107294155081, 4.124382743960786e6)
 Visual{KepOrbit{Float64}, Float64}(KepOrbit(9.79, 0.0281, 0.603, -0.305, 1.42, 44100.0, 1.13), 50.03455280937631, 4.1224472822397854e6)
 Visual{KepOrbit{Float64}, Float64}(KepOrbit(9.98, 0.169, 0.594, 1.1, 0.426, 44800.0, 1.25), 49.95435475420174, 4.129065569198391e6)
 ⋮
 Visual{KepOrbit{Float64}, Float64}(KepOrbit(14.3, 0.0127, 0.874, 2.01, 0.528, 43900.0, 1.29), 49.95205644509205, 4.1292555487445313e6)
 Visual{KepOrbit{Float64}, Float64}(KepOrbit(15.3, 0.335, 0.831, 3.07, 1.35, 49700.0, 1.28), 50.00437897635054, 4.124934865097492e6)
 Visual{KepOrbit{Float64}, Float64}(KepOrbit(10.1, 0.112, 0.647, 1.41, 0.881, 46100.0, 1.15), 50.01671242780641, 4.1239177114012996e6)
 Visual{KepOrbit{Float64}, Float64}(KepOrbit(11.9, 0.0371, 0.637, 0.966, 3.86, 50300.0, 1.15), 49.9832450326463, 4.1266789723711526e6)
 Visual{KepOrbit{Float64}, Float64}(KepOrbit(12.3, 0.148, 0.71, -2.55, 3.17, 40500.0, 1.24), 50.00797999880363, 4.1246378328424976e6)
 Visual{KepOrbit{Float64}, Float64}(KepOrbit(13.2, 0.204, 0.643, -2.65, 1.27, 34100.0, 1.13), 49.98654503045293, 4.126406538428195e6)
 Visual{KepOrbit{Float64}, Float64}(KepOrbit(10.9, 0.189, 0.546, 0.538, 6.25, 41200.0, 1.12), 49.999535001967836, 4.1253344903903278e6)
 Visual{KepOrbit{Float64}, Float64}(KepOrbit(13.7, 0.0737, 0.695, 1.78, 3.35, 33400.0, 1.08), 50.016484810725395, 4.12393647869603e6)
 Visual{KepOrbit{Float64}, Float64}(KepOrbit(11.4, 0.0496, 0.634, -0.734, 3.84, 46900.0, 1.13), 49.992989136501514, 4.1258746438207207e6)</code></pre><p>Calculate and plot the location the planet would be at each observation epoch:</p><pre><code class="language-julia hljs">using CairoMakie

epochs = astrom_obs.table.epoch&#39; # transpose

x = raoff.(orbits, epochs)[:]
y = decoff.(orbits, epochs)[:]

fig = Figure()
ax = Axis(
    fig[1,1], xlabel=&quot;ra offset [mas]&quot;, ylabel=&quot;dec offset [mas]&quot;,
    xreversed=true,
    aspect=1
)
for orbit in orbits
    Makie.lines!(ax, orbit, color=:lightgrey)
end

Makie.scatter!(
    ax,
    x, y,
    markersize=3,
)
fig

Makie.scatter!(ax, astrom_obs.table.ra, astrom_obs.table.dec,color=:black, label=&quot;observed&quot;)
Makie.scatter!(ax, [0],[0], marker=&#39;⋆&#39;, color=:black, markersize=20,label=&quot;&quot;)
Makie.xlims!(400,-700)
Makie.ylims!(-200,200)
fig</code></pre><img src="0645e39c.png" alt="Example block output"/><p>Looks like a great match to the data! Notice how the uncertainty around the middle point is lower than the ends. That&#39;s because the orbit&#39;s posterior location at that epoch is also constrained by the surrounding data points. We can know the location of the planet in hindsight better than we could measure it!</p><p>You can follow this same procedure for any kind of data modelled with Octofitter.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../prior-pred/">« Prior Predictive Checks</a><a class="docs-footer-nextpage" href="../cross-validation/">Cross Validation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Saturday 14 February 2026 21:07">Saturday 14 February 2026</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
