<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Generating and Fitting Simulated Data · Octofitter.jl</title><meta name="title" content="Generating and Fitting Simulated Data · Octofitter.jl"/><meta property="og:title" content="Generating and Fitting Simulated Data · Octofitter.jl"/><meta property="twitter:title" content="Generating and Fitting Simulated Data · Octofitter.jl"/><meta name="description" content="Documentation for Octofitter.jl."/><meta property="og:description" content="Documentation for Octofitter.jl."/><meta property="twitter:description" content="Documentation for Octofitter.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="Octofitter.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Octofitter.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../quick-start/">Quick Start</a></li><li><a class="tocitem" href="../migration/">Migration Guide</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Relative Astrometry</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../rel-astrom/">Basic Astrom Fit</a></li><li><a class="tocitem" href="../rel-astrom-obs/">Observable Priors</a></li><li><a class="tocitem" href="../fit-coplanar/">Resonant Co-Planar Model</a></li><li><a class="tocitem" href="../thiele-innes/">Thiele-Innes Parameters</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Radial Velocity</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../rv-1/">Basic RV Fit</a></li><li><a class="tocitem" href="../rv-gp/">Gaussian Process</a></li><li><a class="tocitem" href="../rv-multi-planet/">Multiple Planets</a></li><li><a class="tocitem" href="../fit-rv-rel/">Relative RV Data</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Absolute Astrometry</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../pma/">Proper Motion Anomaly</a></li><li><a class="tocitem" href="../hipparcos/">Hipparcos IAD</a></li><li><a class="tocitem" href="../gaia-iad/">Gaia DR4 IAD</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-4" type="checkbox"/><label class="tocitem" for="menuitem-3-4"><span class="docs-label">Images and More</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../images/">Image Data (de-orbiting)</a></li><li><a class="tocitem" href="../extract-phot-astrom/">Extract Astrom. and Photometry</a></li><li><a class="tocitem" href="../mass-photometry/">Connect Mass and Photometry</a></li><li><a class="tocitem" href="../fit-interfere/">Interferometer Data</a></li><li><a class="tocitem" href="../fit-likemap/">Likelihood Map</a></li><li><a class="tocitem" href="../fit-grav-wide/">GRAVITY Wide Data</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-5" type="checkbox"/><label class="tocitem" for="menuitem-3-5"><span class="docs-label">Joint Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../astrom-pma-rv/">Astrometry, PMA, and RV</a></li><li><a class="tocitem" href="../fit-rv-astrom/">RV and Relative Astrometry</a></li><li><a class="tocitem" href="../rv/">RV and Proper Motion Anomaly</a></li><li><a class="tocitem" href="../limits/">Calculate Detection Limits</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-6" type="checkbox" checked/><label class="tocitem" for="menuitem-3-6"><span class="docs-label">Bayesian Workflows</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Generating and Fitting Simulated Data</a><ul class="internal"><li><a class="tocitem" href="#Setup"><span>Setup</span></a></li><li><a class="tocitem" href="#Define-the-Model"><span>Define the Model</span></a></li><li><a class="tocitem" href="#Generate-Synthetic-Data"><span>Generate Synthetic Data</span></a></li><li><a class="tocitem" href="#Generate-synthetic-system-with-simulated-data"><span>Generate synthetic system with simulated data</span></a></li><li><a class="tocitem" href="#Fit-the-Simulated-Data"><span>Fit the Simulated Data</span></a></li><li><a class="tocitem" href="#Compare-Results"><span>Compare Results</span></a></li><li><a class="tocitem" href="#Overlay-True-and-Recovered-Parameters"><span>Overlay True and Recovered Parameters</span></a></li><li><a class="tocitem" href="#Corner-Plot-Comparison"><span>Corner Plot Comparison</span></a></li></ul></li><li><a class="tocitem" href="../prior-pred/">Prior Predictive Checks</a></li><li><a class="tocitem" href="../post-pred/">Posterior Predictive Checks</a></li><li><a class="tocitem" href="../cross-validation/">Cross Validation</a></li><li><a class="tocitem" href="../sbc/">Simulation Based Calibration</a></li></ul></li></ul></li><li><span class="tocitem">Documentation</span><ul><li><a class="tocitem" href="../python/">Using Python</a></li><li><a class="tocitem" href="../chains/">Chains</a></li><li><a class="tocitem" href="../octoplot/">Orbit plots with <code>octoplot</code></a></li><li><a class="tocitem" href="../rvpostplot/">RV plots with <code>rvpostplot</code></a></li><li><a class="tocitem" href="../loading-saving/">Loading and Saving Data</a></li><li><a class="tocitem" href="../samplers/">Sampler</a></li><li><a class="tocitem" href="../parallel-sampling/">Distributed Sampling</a></li><li><a class="tocitem" href="../priors/">Priors</a></li><li><a class="tocitem" href="../derived/">Derived Variables</a></li><li><a class="tocitem" href="../custom-likelihood/">Custom Likelihoods</a></li><li><a class="tocitem" href="../kepler/">Kepler Solver</a></li><li><a class="tocitem" href="../compat-orbitize/">Orbitize! Compatibility</a></li><li><a class="tocitem" href="../api/">Full API Documentation</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li><a class="is-disabled">Bayesian Workflows</a></li><li class="is-active"><a href>Generating and Fitting Simulated Data</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Generating and Fitting Simulated Data</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/sefffal/Octofitter.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/sefffal/Octofitter.jl/blob/main/docs/src/data-simulation.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="data-simulation"><a class="docs-heading-anchor" href="#data-simulation">Generating and Fitting Simulated Data</a><a id="data-simulation-1"></a><a class="docs-heading-anchor-permalink" href="#data-simulation" title="Permalink"></a></h1><p>This tutorial demonstrates how to use Octofitter to simulate synthetic data, fit models to that data, and validate the results. This is a crucial workflow for understanding model performance and testing analysis pipelines.</p><p>We&#39;ll simulate data from a known set of parameters, fit a model to recover those parameters, and compare the posterior to the true values used for simulation.</p><h2 id="Setup"><a class="docs-heading-anchor" href="#Setup">Setup</a><a id="Setup-1"></a><a class="docs-heading-anchor-permalink" href="#Setup" title="Permalink"></a></h2><pre><code class="language-julia hljs">using Octofitter, OctofitterRadialVelocity, Distributions
using CairoMakie, PairPlots, Pigeons
using CSV, DataFrames</code></pre><h2 id="Define-the-Model"><a class="docs-heading-anchor" href="#Define-the-Model">Define the Model</a><a id="Define-the-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Define-the-Model" title="Permalink"></a></h2><p>In order to simulate data from Octofitter, you start by defining a real model with data. The simulate step will use the provided epochs, data types, and uncertainties when simulating data. If you don&#39;t have real data, you can enter in arbitrary values for e.g. delta R.A., but use expected epochs and uncertainties.</p><p>For this example, we&#39;ll use the combined astrometry, proper motion anomaly, and radial velocity model from the <a href="../astrom-pma-rv/#astrom-pma-rv">Astrometry, PMA, and RV</a> tutorial to define the epochs and uncertainties.</p><pre><code class="language-julia hljs"># HGCA likelihood for HD 91312
hgca_like = HGCALikelihood(gaia_id=756291174721509376)

#  relative astrometry data (from discovery paper)
astrom_dat = Table(;
    epoch = [mjd(&quot;2016-12-15&quot;), mjd(&quot;2017-03-12&quot;), mjd(&quot;2017-03-13&quot;), mjd(&quot;2018-02-08&quot;), mjd(&quot;2018-11-28&quot;), mjd(&quot;2018-12-15&quot;)],
    ra    = [133., 126., 127., 083., 058., 056.],
    dec   = [-174., -176., -172., -133., -122., -104.],
    σ_ra  = [07.0, 04.0, 04.0, 10.0, 10.0, 08.0],
    σ_dec = [07.0, 04.0, 04.0, 10.0, 20.0, 08.0],
    cor   = [0.2, 0.3, 0.1, 0.4, 0.3, 0.2]
)

astrom_like = PlanetRelAstromLikelihood(
    astrom_dat,
    name = &quot;SCExAO&quot;,
    variables = @variables begin
        jitter = 0
        northangle = 0
        platescale = 1
    end
)

#  RV data
rv_dat = Table(;
    epoch = [mjd(&quot;2008-05-01&quot;), mjd(&quot;2010-02-15&quot;), mjd(&quot;2016-03-01&quot;)],
    rv    = [1300, 700, -2700],
    σ_rv  = [150, 150, 150]
)

rvlike = StarAbsoluteRVLikelihood(
    rv_dat,
    name=&quot;SOPHIE&quot;,
    variables=@variables begin
        jitter ~ truncated(Normal(10, 5), lower=0)
        offset ~ Normal(0, 1000)
    end
)

# Planet model
planet_b = Planet(
    name=&quot;b&quot;,
    basis=AbsoluteVisual{KepOrbit},
    likelihoods=[ObsPriorAstromONeil2019(astrom_like)],
    variables=@variables begin
        a ~ LogUniform(0.1,400)
        e ~ Uniform(0,0.999)
        ω ~ Uniform(0, 2pi)
        i ~ Sine()
        Ω ~ Uniform(0, 2pi)
        mass = system.M_sec
        θ ~ Uniform(0, 2pi)
        M = system.M
        tp = θ_at_epoch_to_tperi(θ, 57737.0; M, e, a, i, ω, Ω)
        F = 0.0
    end
)

# System model
ra = 158.30707896392835
dec = 40.42555422701387

sys = System(
    name=&quot;HD91312_simulation&quot;,
    companions=[planet_b],
    likelihoods=[hgca_like, rvlike],
    variables=@variables begin
        M_pri ~ truncated(Normal(1.61, 0.1), lower=0.1)
        M_sec ~ LogUniform(0.5, 1000)
        M = M_pri + M_sec*Octofitter.mjup2msol
        plx ~ gaia_plx(gaia_id=756291174721509376)
        pmra ~ Normal(-137, 10)
        pmdec ~ Normal(2, 10)
        ra = $ra
        dec = $dec
        rv = 0*1e3
        ref_epoch = Octofitter.meta_gaia_DR3.ref_epoch_mjd
    end
)

model = Octofitter.LogDensityModel(sys)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">┌ Warning: Only stars with solution types 5 are currently supported. This sol is 7.0. If you need solution type 1, 7, or 9, please open an issue on GitHub and we would be happy to add it.
└ @ Octofitter ~/work/Octofitter.jl/Octofitter.jl/src/likelihoods/hipparcos.jl:192
[ Info: renormalizing hipparcos uncertainties according to Nielsen et al (2020). Pass `renormalize=false` to disable.
[ Info: No scan law table provided. We will fetch an approximate solution from the GOST webservice.
┌ Info: Detected known gap in Gaia scans; skipping.
│   window = 57175.48233750556
└   note = &quot;Decontamination&quot;
[ Info: Preparing model
┌ Info: Determined number of free variables
└   D = 13
┌ Info: Determined number type
└   T = Float64
ℓπcallback(θ): 0.000148 seconds (78 allocations: 84.312 KiB)
∇ℓπcallback(θ): 0.001042 seconds (24 allocations: 152.391 KiB)</code></pre><h2 id="Generate-Synthetic-Data"><a class="docs-heading-anchor" href="#Generate-Synthetic-Data">Generate Synthetic Data</a><a id="Generate-Synthetic-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Generate-Synthetic-Data" title="Permalink"></a></h2><p>We have three choices for generating simulated data:</p><ol><li>Draw values from the priors</li><li>Use values from a fitted posterior </li><li>Specifying values manually</li></ol><p>We will look at each.</p><h3 id="1.-Draw-values-from-the-priors"><a class="docs-heading-anchor" href="#1.-Draw-values-from-the-priors">1. Draw values from the priors</a><a id="1.-Draw-values-from-the-priors-1"></a><a class="docs-heading-anchor-permalink" href="#1.-Draw-values-from-the-priors" title="Permalink"></a></h3><p>We can draw a value from the priors like so:</p><pre><code class="language-julia hljs">params_to_simulate = Octofitter.drawfrompriors(model.system)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(M_pri = 1.5562986319255552, M_sec = 10.347465336014558, plx = 29.118268387196267, pmra = -127.94961948113367, pmdec = -11.183875245402653, M = 1.566176262671512, ra = 158.30707896392835, dec = 40.42555422701387, rv = 0.0, ref_epoch = 57388.5, observations = (SOPHIE = (jitter = 5.499230860761885, offset = -187.44375737101257),), planets = (b = (a = 13.332176157916468, e = 0.7046170387475686, ω = 3.172046394443539, i = 1.8933071613532866, Ω = 5.469217899998308, θ = 5.639780995632805, mass = 10.347465336014558, M = 1.566176262671512, tp = 54694.40569689927, F = 0.0, observations = (obspri_SCExAO = (jitter = 0, northangle = 0, platescale = 1),)),))</code></pre><h3 id="2.-Use-values-from-a-fitted-posterior"><a class="docs-heading-anchor" href="#2.-Use-values-from-a-fitted-posterior">2. Use values from a fitted posterior</a><a id="2.-Use-values-from-a-fitted-posterior-1"></a><a class="docs-heading-anchor-permalink" href="#2.-Use-values-from-a-fitted-posterior" title="Permalink"></a></h3><p>We can select a particular draw from the posterior and use this to generate new data</p><pre><code class="language-julia hljs"># Perform MCMC fitting on real data
using Pigeons
chain_real, pt = octofit_pigeons(model, n_rounds=5)

# Use one particular draw as the basis of our simulation
draw_number = 1
params_to_simulate = Octofitter.mcmcchain2result(model, chain_real, draw_number)</code></pre><h3 id="Specifying-values-manually"><a class="docs-heading-anchor" href="#Specifying-values-manually">Specifying values manually</a><a id="Specifying-values-manually-1"></a><a class="docs-heading-anchor-permalink" href="#Specifying-values-manually" title="Permalink"></a></h3><p>We can also specify all values for the simulation manually. This process is a bit more involved. </p><p>Start by drawing parameters from the priors:</p><pre><code class="language-julia hljs">template = Octofitter.drawfrompriors(model.system)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(M_pri = 1.5476050121013458, M_sec = 673.0608196917726, plx = 29.133801224413578, pmra = -144.65193222974793, pmdec = 4.050878734755731, M = 2.1901049896897793, ra = 158.30707896392835, dec = 40.42555422701387, rv = 0.0, ref_epoch = 57388.5, observations = (SOPHIE = (jitter = 12.466066600549926, offset = 1338.673719329046),), planets = (b = (a = 38.122780455556125, e = 0.1700453043911487, ω = 1.5602361119870258, i = 0.37314499294146414, Ω = 5.108649912355986, θ = 1.0219160163400411, mass = 673.0608196917726, M = 2.1901049896897793, tp = 53772.267370459755, F = 0.0, observations = (obspri_SCExAO = (jitter = 0, northangle = 0, platescale = 1),)),))</code></pre><p>Copy this output as a template, and replace values as needed. Note that if some parameters are calculated based on others in your model, you will have to repeat those calculations here.</p><div class="admonition is-warning" id="Warning-5633040dc97cd1e4"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-5633040dc97cd1e4" title="Permalink"></a></header><div class="admonition-body"><p>Note that the output below is just an example, you must generate your own template from your model and modify it as needed. The exact structure is not garuanteed to be stable between versions of Octofitter.</p></div></div><pre><code class="language-julia hljs"># Define our &quot;true&quot; parameter values for simulation
M_pri = 1.61
M_sec = 85.0
M = M_pri + M_sec*Octofitter.mjup2msol
params_to_simulate = (
    M_pri = M_pri,
    M_sec = M_sec,  # Jupiter masses
    M = M,
    plx = 21.5,
    pmra = -137.0,
    pmdec = 2.0,
    ra = ra,
    dec = dec,
    rv = 0.0,
    ref_epoch = Octofitter.meta_gaia_DR3.ref_epoch_mjd,
    observations = (
        SOPHIE = (jitter = 15.0, offset = 0.0),
    ),
    planets = (
        b = (
            a = 45.0,
            e = 0.15,
            ω = 1.2,
            mass = M_sec,
            i = 0.8,
            Ω = 2.1,
            θ = 1.5,
            M = M,
            tp = θ_at_epoch_to_tperi(1.5, 57737.0; M=M, e=0.15, a=45.0, i=0.8, ω=1.2, Ω=2.1),
            F = 0.0,
            observations = NamedTuple()
        ),
    )
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(M_pri = 1.61, M_sec = 85.0, M = 1.6911405098873926, plx = 21.5, pmra = -137.0, pmdec = 2.0, ra = 158.30707896392835, dec = 40.42555422701387, rv = 0.0, ref_epoch = 57388.5, observations = (SOPHIE = (jitter = 15.0, offset = 0.0),), planets = (b = (a = 45.0, e = 0.15, ω = 1.2, mass = 85.0, i = 0.8, Ω = 2.1, θ = 1.5, M = 1.6911405098873926, tp = -4260.340997684594, F = 0.0, observations = NamedTuple()),))</code></pre><h2 id="Generate-synthetic-system-with-simulated-data"><a class="docs-heading-anchor" href="#Generate-synthetic-system-with-simulated-data">Generate synthetic system with simulated data</a><a id="Generate-synthetic-system-with-simulated-data-1"></a><a class="docs-heading-anchor-permalink" href="#Generate-synthetic-system-with-simulated-data" title="Permalink"></a></h2><pre><code class="language-julia hljs">sim_system = Octofitter.generate_from_params(model.system, params_to_simulate)
sim_model = Octofitter.LogDensityModel(sim_system)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">LogDensityModel for System HD91312_simulation of dimension 13 and 10 epochs with fields .ℓπcallback and .∇ℓπcallback
</code></pre><p>Let&#39;s plot the simulated orbit and data to see what we generated:</p><pre><code class="language-julia hljs"># Convert true parameters to chain format for plotting
true_chain = Octofitter.result2mcmcchain([params_to_simulate])

# Plot the simulated system with true parameters
fig = octoplot(sim_model, true_chain, colormap=:red)
fig</code></pre><img src="afbd691d.png" alt="Example block output"/><h2 id="Fit-the-Simulated-Data"><a class="docs-heading-anchor" href="#Fit-the-Simulated-Data">Fit the Simulated Data</a><a id="Fit-the-Simulated-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Fit-the-Simulated-Data" title="Permalink"></a></h2><p>Now we&#39;ll sample from the posterior using the simulated data:</p><pre><code class="language-julia hljs"># Sample from the simulated data
chain, pt = octofit_pigeons(sim_model, n_rounds=8, explorer=SliceSampler())
display(chain)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[ Info: Sampler running with multiple threads     : true
[ Info: Likelihood evaluated with multiple threads: false
┌ Info: Starting values not provided for all parameters! Guessing starting point using global optimization:
│   num_params = 13
└   num_fixed = 0
┌ Info: Found sample of initial positions
│   logpost_range = (-79.16063454708186, -68.94063608018524)
└   mean_logpost = -71.95246722456072
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  scans     restarts      Λ        Λ_var      time(s)    allc(B)  log(Z₁/Z₀)   min(α)     mean(α)    min(αₑ)   mean(αₑ)
────────── ────────── ────────── ────────── ────────── ────────── ────────── ────────── ────────── ────────── ──────────
        2          0       1.69       3.39       4.02   2.32e+09  -4.09e+04          0      0.836          1          1
        4          0       8.33       4.05          7   4.27e+09  -2.54e+03          0      0.601          1          1
        8          0       8.02       4.94       13.6   8.32e+09       -449          0      0.582          1          1
       16          0       8.16       7.51       26.5   1.63e+10       -150   7.06e-72      0.494          1          1
       32          0       8.48       7.25       51.8   3.18e+10        -87   2.15e-15      0.493      0.999          1
       64          1       9.07       5.61        103    6.3e+10      -80.4      0.241      0.527          1          1
      128          6       9.61       5.46        206   1.27e+11      -80.2      0.261      0.514          1          1
      256          6        9.3        5.7        413   2.54e+11      -80.1      0.296      0.516          1          1
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</code></pre><h2 id="Compare-Results"><a class="docs-heading-anchor" href="#Compare-Results">Compare Results</a><a id="Compare-Results-1"></a><a class="docs-heading-anchor-permalink" href="#Compare-Results" title="Permalink"></a></h2><p>Let&#39;s visualize how well our sampling recovered the true parameters:</p><pre><code class="language-julia hljs"># Plot the posterior from fitting simulated data
fig = octoplot(sim_model, chain)
fig</code></pre><img src="1ebe518a.png" alt="Example block output"/><h2 id="Overlay-True-and-Recovered-Parameters"><a class="docs-heading-anchor" href="#Overlay-True-and-Recovered-Parameters">Overlay True and Recovered Parameters</a><a id="Overlay-True-and-Recovered-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Overlay-True-and-Recovered-Parameters" title="Permalink"></a></h2><p>For a direct comparison, we can overlay the true orbit with the posterior samples:</p><pre><code class="language-julia hljs"># Create astrometry plot showing both posterior and true orbit
fig = Octofitter.astromplot(sim_model, chain, use_arcsec=false, ts=1:2)
ax = fig.content[1]

# Add true orbit in red
Octofitter.astromplot!(ax, sim_model, true_chain, use_arcsec=false, ts=1:2, colormap=Makie.cgrad([:red]))

# Make true orbit line more visible
ax.scene.plots[6].linewidth = 6

fig</code></pre><img src="f98123b4.png" alt="Example block output"/><h2 id="Corner-Plot-Comparison"><a class="docs-heading-anchor" href="#Corner-Plot-Comparison">Corner Plot Comparison</a><a id="Corner-Plot-Comparison-1"></a><a class="docs-heading-anchor-permalink" href="#Corner-Plot-Comparison" title="Permalink"></a></h2><p>Compare the parameters used to generate the simulated data, and the recovered posterior:</p><pre><code class="language-julia hljs"># Create corner plot showing both posterior and true values
octocorner(
    sim_model,
    chain,
    small=true,
    truth=(PairPlots.Truth((;
        M=collect(true_chain[:M][:]),
        b_a=collect(true_chain[:b_a][:]),
        b_e=collect(true_chain[:b_e][:]),
        b_i=collect(true_chain[:b_i][:]),
        b_mass=collect(true_chain[:b_mass][:]),
    ),label=&quot;Simulated Orbit&quot;, color=:red)=&gt;(
        PairPlots.MarginLines(),
        PairPlots.BodyLines(),
    ),)
)</code></pre><img src="769bb30a.png" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../limits/">« Calculate Detection Limits</a><a class="docs-footer-nextpage" href="../prior-pred/">Prior Predictive Checks »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 15 July 2025 21:22">Tuesday 15 July 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
